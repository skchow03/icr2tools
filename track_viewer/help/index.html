<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Track Viewer — User Manual</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    :root {
      --bg: #f9f9f9;
      --fg: #222;
      --muted: #666;
      --border: #ddd;
      --accent: #2b6cb0;
      --code-bg: #f1f1f1;
      --callout-bg: #eef4fb;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      background: var(--bg);
      color: var(--fg);
      line-height: 1.6;
    }

    header {
      padding: 1.5rem 2rem;
      border-bottom: 1px solid var(--border);
      background: #fff;
    }

    header h1 {
      margin: 0;
      font-size: 1.7rem;
      font-weight: 600;
    }

    header p {
      margin: 0.5rem 0 0;
      color: var(--muted);
    }

    main {
      display: grid;
      grid-template-columns: 280px 1fr;
      min-height: calc(100vh - 96px);
    }

    nav {
      border-right: 1px solid var(--border);
      background: #fff;
      padding: 1.5rem;
      position: sticky;
      top: 0;
      align-self: start;
      height: 100vh;
      overflow-y: auto;
    }

    nav h2 {
      font-size: 0.9rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--muted);
      margin-top: 0;
    }

    nav ul {
      list-style: none;
      padding: 0;
      margin: 1rem 0 0;
    }

    nav li {
      margin: 0.5rem 0;
    }

    nav a {
      text-decoration: none;
      color: var(--fg);
    }

    nav a:hover {
      text-decoration: underline;
      color: var(--accent);
    }

    section {
      padding: 2rem;
      max-width: 980px;
    }

    section h2 {
      margin-top: 0;
      font-size: 1.5rem;
      font-weight: 600;
    }

    section h3 {
      margin-top: 1.8rem;
      font-size: 1.15rem;
      font-weight: 600;
    }

    .callout {
      border-left: 4px solid var(--accent);
      background: var(--callout-bg);
      padding: 0.9rem 1.1rem;
      margin: 1.2rem 0;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 1rem;
      margin: 1rem 0;
    }

    .card {
      background: #fff;
      border: 1px solid var(--border);
      border-radius: 6px;
      padding: 0.9rem;
    }

    code {
      background: var(--code-bg);
      padding: 0.1rem 0.3rem;
      border-radius: 3px;
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      font-size: 0.9em;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin: 1rem 0;
      background: #fff;
    }

    th,
    td {
      padding: 0.6rem 0.75rem;
      border: 1px solid var(--border);
      text-align: left;
      vertical-align: top;
    }

    th {
      background: #f5f5f5;
    }

    footer {
      border-top: 1px solid var(--border);
      padding: 1rem 2rem 2rem;
      color: var(--muted);
      font-size: 0.85rem;
      background: #fff;
    }

    @media (max-width: 900px) {
      main {
        grid-template-columns: 1fr;
      }

      nav {
        position: relative;
        height: auto;
        border-right: none;
        border-bottom: 1px solid var(--border);
      }
    }
  </style>
</head>

<body>
  <header>
    <h1>Track Viewer — User Manual</h1>
    <p>Offline documentation for the ICR2 Track Viewer</p>
  </header>

  <main>
    <nav>
      <h2>Contents</h2>
      <ul>
        <li><a href="#overview">Overview</a></li>
        <li><a href="#requirements">Requirements</a></li>
        <li><a href="#getting-started">Getting Started</a></li>
        <li><a href="#ui-tour">Interface Tour</a></li>
        <li><a href="#preview-window">Preview Window</a></li>
        <li><a href="#selection">Selection & Interaction</a></li>
        <li><a href="#cameras">Camera Editing</a></li>
        <li><a href="#ai-lines">AI Line (LP) Inspection</a></li>
        <li><a href="#track-txt">Track.txt & PIT Editing</a></li>
        <li><a href="#replay-tools">Replay & Weather Tools</a></li>
        <li><a href="#tools-menu">Tools Menu</a></li>
        <li><a href="#saving">Saving & Backups</a></li>
        <li><a href="#shortcuts">Shortcuts & Tips</a></li>
        <li><a href="#troubleshooting">Troubleshooting</a></li>
        <li><a href="#limitations">Limitations</a></li>
      </ul>
    </nav>

    <section>
      <h2 id="overview">Overview</h2>
      <p>
        Track Viewer is a desktop tool for inspecting and editing
        <strong>IndyCar Racing II (ICR2)</strong> track data. It is designed
        for track builders and modders who want precise, visual control over
        cameras, AI lines, and other track parameters without overwriting the original files
        until they explicitly save.
      </p>

      <div class="grid">
        <div class="card">
          <h3>Core Capabilities</h3>
          <ul>
            <li>Display TRK geometry, centerlines, and track boundaries.</li>
            <li>Visualize and compare AI driving lines (LP files).</li>
            <li>Edit camera positions, angles, and roll values.</li>
            <li>Inspect and update track.txt parameters.</li>
            <li>Export supporting data via tool dialogs.</li>
          </ul>
        </div>
        <div class="card">
          <h3>What It Does Not Do</h3>
          <ul>
            <li>It does not alter track geometry.</li>
            <li>It does not auto-save; you must save changes manually.</li>
            <li>It does not replace in-game testing or validation.</li>
          </ul>
        </div>
      </div>

      <div class="callout">
        This manual ships with the application and matches the exact version you are running.
        No internet connection is required.
      </div>

      <h2 id="requirements">Requirements</h2>
      <ul>
        <li>A valid ICR2 installation with a TRACKS subfolder containing individual track folders with at least a <code>.TRK</code> file.</li>
        <li>Expected: <code>.LP</code> AI lines, <code>.CAM</code>/<code>.SCR</code> cameras,
          and <code>track.txt</code> for track parameter editing. .CAM and .SCR files may exist within a .DAT file or as loose files in the track folder.</li>
      </ul>

      <h2 id="getting-started">Getting Started</h2>
      <ol>
        <li>Launch Track Viewer.</li>
        <li>(First time running the app) Choose <strong>File → Open ICR2 folder</strong>.</li>
        <li>The app will attempt to locate the TRACK subfolder containing the track files.</li>
        <li>Use the track list drop-down to switch between available tracks.</li>
      </ol>

      <p>
        If a file is missing or unreadable, the viewer continues loading with reduced
        functionality. Errors appear in the status bar and logs.
      </p>

      <h2 id="ui-tour">Interface Tour</h2>
      <div class="grid">
        <div class="card">
          <h3>Main Toolbar Area</h3>
          <p>Contains track selection, view toggles, and quick actions.</p>
        </div>
        <div class="card">
          <h3>Preview Window</h3>
          <p>Interactive view of the track, AI lines, and overlays.</p>
        </div>
        <div class="card">
          <h3>Tabs Panel</h3>
          <p>Editing tabs for AI lines, cameras, track.txt, weather, and replay data.</p>
        </div>
        <div class="card">
          <h3>Status Bar</h3>
          <p>Shows load status, coordinates, warnings, and feedback.</p>
        </div>
      </div>

      <h2 id="preview-window">Preview Window</h2>
      <p>
        The preview window is the primary visualization surface. It renders the track
        geometry, AI lines, camera helpers, and selection markers. Use the view toggles
        in the toolbar and View menu to control what is displayed.
      </p>

      <h3>Navigation</h3>
      <ul>
        <li><strong>Pan:</strong> click and drag with the left mouse button.</li>
        <li><strong>Zoom:</strong> mouse wheel to zoom in/out.</li>
      </ul>

      <h3>Overlays</h3>
      <ul>
        <li><strong>View > Show Boundaries:</strong> shows the boundaries (walls).</li>
        <li><strong>View > Show Section dividers:</strong> visualize TRK section breaks.</li>
        <li><strong>AI line colors (editable in .ini file):</strong> multiple LP files are colored for comparison.</li>
        <li><strong>Camera markers (when in Camera mode):</strong> show camera positions and aiming direction for fixed cameras.</li>
      </ul>

      <h2 id="selection">Selection & Interaction</h2>
      <p>
        Click to select items (AI line records or cameras depending on
        the active tab). The sidebar and tab fields update to show the selected element’s
        details. When available, the coordinate sidebar displays exact X/Y positions.
      </p>

      <h3>Selection Tips</h3>
      <ul>
        <li>Use the <strong>Center on selection</strong> toggle in the LP Speed Graph to stay focused.</li>
        <li>Section tables allow row-based selection and will highlight the relevant area.</li>
        <li>Some selections are read-only; editable selections are highlighted in the tab fields.</li>
      </ul>

      <h2 id="cameras">Camera Editing</h2>
      <p>
        Camera editing is available in the Cameras tab. Track Viewer can load camera data
        from <code>.CAM</code>, <code>.SCR</code>, or embedded DAT files and will save back to
        the file type you loaded.
      </p>

      <h3>Editing Workflow</h3>
      <ol>
        <li>If there is more than one TV mode (i.e. TV1, TV2), you may choose to only show cameras used in that mode.</li>
        <li>Select a camera from the list or by clicking on the icon in the preview window.</li>
        <li>Adjust position, yaw, pitch, or roll values using the fields.</li>
        <li>Use the preview window to visually confirm changes.</li>
        <li>Click <strong>Save Cameras</strong> to write changes to disk.</li>
      </ol>

      <div class="callout">
        Camera edits are not saved automatically. The Cameras tab title updates when there
        are unsaved changes.
      </div>

      <h2 id="ai-lines">AI Line (LP) Inspection</h2>
      <p>
        The LP tab displays AI line data (typically <code>LP1</code> through <code>LP4</code>)
        with color-coded overlays. You can inspect speed values at each DLONG point using
        the LP Speed Graph.
      </p>

      <h3>LP Speed Graph</h3>
      <ul>
        <li>Use zoom controls (X+/X-/Y+/Y-) for detailed inspection.</li>
        <li>Enable <strong>Center on selection</strong> to keep the selected point in view.</li>
        <li>Graph selection syncs with the preview window selection.</li>
      </ul>

      <h2 id="track-txt">Track.txt &amp; PIT Editing</h2>
      <p>
        Track Viewer supports editing key fields in <code>track.txt</code>, including PIT
        and metadata values. The Track.txt tab shows editable fields with clear labels
        and validation.
      </p>

      <h3>PIT Parameters</h3>
      <ul>
        <li>Adjust pit lane counts, entry/exit positions, and speed limits.</li>
        <li>Use the preview markers to confirm physical placement.</li>
        <li>Changes are staged until you click <strong>Save Track.txt</strong>.</li>
      </ul>

      <h2 id="replay-tools">Replay &amp; Weather Tools</h2>
      <p>
        The Replay tab exposes lap parameters for replay timing. The Weather tab provides
        wind and weather adjustments that influence visualization, such as wind heading
        and compass offsets.
      </p>

      <h2 id="tools-menu">Tools Menu</h2>
      <table>
        <thead>
          <tr>
            <th>Tool</th>
            <th>Purpose</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>TRK Gaps</td>
            <td>Analyze potential geometry gaps in the TRK data.</td>
          </tr>
          <tr>
            <td>TRK → SG</td>
            <td>Convert TRK geometry to a Sketchpad-friendly format.</td>
          </tr>
          <tr>
            <td>TRK → CSV</td>
            <td>Export TRK geometry points to CSV for external analysis.</td>
          </tr>
          <tr>
            <td>Track Map Preview</td>
            <td>Open a separate preview of the track map rendering.</td>
          </tr>
        </tbody>
      </table>

      <h2 id="saving">Saving &amp; Backups</h2>
      <p>
        Saving is explicit. Track Viewer will not overwrite files until you use the
        save actions in each tab. When saving, the tool writes backups to allow rollback.
      </p>

      <h3>Save Buttons by Tab</h3>
      <ul>
        <li><strong>Cameras:</strong> Save Cameras</li>
        <li><strong>Track.txt:</strong> Save Track.txt</li>
        <li><strong>Weather:</strong> Save Weather</li>
      </ul>

      <div class="callout">
        If you switch tracks or close the app with unsaved changes, you will be prompted
        to confirm. This protects you from accidental data loss.
      </div>

      <h2 id="shortcuts">Shortcuts &amp; Tips</h2>
      <table>
        <thead>
          <tr>
            <th>Action</th>
            <th>Shortcut / Gesture</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Pan</td>
            <td>Middle mouse drag</td>
          </tr>
          <tr>
            <td>Zoom</td>
            <td>Mouse wheel</td>
          </tr>
          <tr>
            <td>Close dialog</td>
            <td>Escape key</td>
          </tr>
        </tbody>
      </table>

      <h3>Workflow Tips</h3>
      <ul>
        <li>Load a track, inspect geometry, then validate AI lines before editing cameras.</li>
        <li>Keep backups of your original track folder before large edits.</li>
        <li>Use the Track Map Preview tool to confirm layout at a glance.</li>
      </ul>

      <h2 id="troubleshooting">Troubleshooting</h2>
      <h3>Track fails to load</h3>
      <ul>
        <li>Confirm the folder contains a valid <code>.TRK</code> file.</li>
        <li>Ensure file names use standard ICR2 naming conventions.</li>
        <li>Check the status bar for error messages.</li>
      </ul>

      <h3>AI line does not appear</h3>
      <ul>
        <li>Verify the <code>.LP</code> files exist in the track folder.</li>
        <li>Use the View menu to ensure AI line overlays are enabled.</li>
        <li>Try reloading the track after making changes.</li>
      </ul>

      <h3>Camera edits not saving</h3>
      <ul>
        <li>Confirm you clicked <strong>Save Cameras</strong> in the Cameras tab.</li>
        <li>Ensure the track folder is writable.</li>
        <li>Look for backup files with the same extension.</li>
      </ul>

      <h2 id="limitations">Limitations</h2>
      <ul>
        <li>Only fields exposed in the UI are editable.</li>
        <li>Some legacy or proprietary formats may load as read-only.</li>
        <li>Manual changes to files outside Track Viewer are not auto-reloaded.</li>
      </ul>
    </section>
  </main>

  <footer>
    Track Viewer — Offline Help • Generated documentation • No network access required
  </footer>
</body>
</html>
